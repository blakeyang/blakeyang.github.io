---
title: iOS内存原理
date: 2019-01-06 11:30:48
categories:
- 技术
tags:
- iOS
keywords: 内存管理、内存释放、ARC、ARC内存原理
---

iOS的内存管理，绝对是很多很多iOSer人的误区。
因为最近几年的iOS开发人员，都没有经历过MRC年代了。
MRC年代的内存总是不好管理，所以ARC帮我们做了很多事情。ARC做了很多事情让内存管理更加精准优秀外，却使得iOS开发人员不知道内存是怎么管理的了。
真正的内存管理，一定需要回到MRC下面去理解，根本思想是：**谁创建、谁释放、谁引用、谁释放**。
**内存释放的唯一途径是：引用计数=0**
自动释放池仅仅做了“谁创建谁释放”里面的一部分。
**ARC帮我们做了“谁创建、谁释放、谁引用、谁释放”四个部分。**
**ARC帮我们写了很多管理内存的代码，包括autolease、retain、release等。如果不理解MRC下面他们的含义，是不可能理解iOS内存管理的。**
**网络上面大多介绍的autolease、autoleasepool、autoleasepoolpage，只是自动释放池部分，只是iOS内存管理的一个面。**
内存不是绝对安全释放的，还牵涉到内存区，如果字符串定义到了堆区，释放是及时的，定义到了栈区和常量区，就不那么及时了（虽然引用计数=0，代码也不能在调用，但是真实内存还在）。